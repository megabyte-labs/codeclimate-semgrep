{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "definitions": {
    "error": {
      "$id": "#/definitions/error",
      "description": "An error encountered while running a check",
      "properties": {
        "code": { "type": "integer" },
        "help": { "type": "string" },
        "level": { "type": "string" },
        "long_msg": { "type": "string" },
        "short_msg": { "type": "string" },
        "spans": {
          "items": {
            "properties": {
              "end": { "$ref": "#/definitions/location" },
              "file": { "type": "string" },
              "source_hash": { "type": "string" },
              "start": { "$ref": "#/definitions/location" }
            },
            "type": "object"
          },
          "type": "array"
        },
        "type": { "type": "string" }
      },
      "type": "object"
    },
    "extra": {
      "$id": "#/definitions/extra",
      "description": "Extra result data",
      "properties": {
        "message": { "type": "string" },
        "metadata": {
          "additionalProperties": true,
          "properties": {
            "cc.categories": {
              "items": {
                "enum": [
                  "Bug Risk",
                  "Clarity",
                  "Compatibility",
                  "Complexity",
                  "Duplication",
                  "Performance",
                  "Security",
                  "Style"
                ],
                "type": "string"
              },
              "type": "array"
            },
            "cc.severity": {
              "enum": ["info", "minor", "major", "critical", "blocker"],
              "type": "string"
            }
          },
          "type": "object"
        },
        "severity": { "enum": ["ERROR", "WARNING", "INFO"], "type": "string" }
      },
      "required": ["message", "severity", "metadata"],
      "type": "object"
    },
    "location": {
      "$id": "#/definitions/location",
      "description": "Position in a file",
      "properties": {
        "col": { "type": "integer" },
        "line": { "type": "integer" }
      },
      "required": ["line", "col"],
      "type": "object"
    },
    "result": {
      "$id": "#/definitions/result",
      "description": "A result matching a check",
      "properties": {
        "check_id": {
          "description": "Identifier for the check that matched",
          "type": "string"
        },
        "end": { "$ref": "#/definitions/location" },
        "extra": { "$ref": "#/definitions/extra" },
        "path": {
          "description": "Location of the matching file",
          "type": "string"
        },
        "start": { "$ref": "#/definitions/location" }
      },
      "required": ["check_id", "path", "start", "end", "extra"],
      "type": "object"
    }
  },
  "description": "A JSON Schema describing the Semgrep output format. This isn't exhaustive, and only implements enough of the output to be useful for our purposes",
  "properties": {
    "errors": {
      "$id": "#/properties/errors",
      "description": "Results from the run",
      "items": { "$ref": "#/definitions/error" },
      "type": "array"
    },
    "results": {
      "$id": "#/properties/results",
      "description": "Results of the run",
      "items": { "$ref": "#/definitions/result" },
      "type": "array"
    }
  },
  "required": ["results", "errors"],
  "title": "Semgrep Output",
  "type": "object"
}
